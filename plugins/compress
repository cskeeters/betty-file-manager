#!/bin/bash

source "$(dirname $0)/helper.sh"

# cd to dir of the current tab so options will be sub-files
cd "$CUR_DIR"
pwd

TYPE=$(cat << EOF | fzf
tgz
zip
tar.bz2
tar
EOF)


if [[ $TYPE == "tgz" ]]; then
    gum spin --title "Tarring ${HOVERED_FILE} to ${HOVERED_FILE}.tgz" -- tar -zcf "${HOVERED_FILE}.tgz" "$HOVERED_FILE"
elif [[ $TYPE == "zip" ]]; then
    gum spin --title "Zipping ${HOVERED_FILE} to ${HOVERED_FILE}.zip" -- zip -r "${HOVERED_FILE}.zip" "$HOVERED_FILE"
elif [[ $TYPE == "tar.bz2" ]]; then
    gum spin --title "Tarring ${HOVERED_FILE} to ${HOVERED_FILE}.tar.bz2" -- tar -jcf "${HOVERED_FILE}.tar.bz2" "$HOVERED_FILE"
else
    exit 1
fi

echo "refresh" >> "$CMD_FILE"
